<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Securial::PasswordResettable
  
    &mdash; Securial Gem Documentation
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Securial::PasswordResettable";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Securial.html" title="Securial (module)">Securial</a></span></span>
     &raquo; 
    <span class="title">PasswordResettable</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Securial::PasswordResettable
  
  
  
</h1>
<div class="box_info">
  

  
  
  <dl>
      <dt>Extended by:</dt>
      <dd>ActiveSupport::Concern</dd>
  </dl>
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="User.html" title="Securial::User (class)">User</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/concerns/securial/password_resettable.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>PasswordResettable Concern</p>

<p>This module provides functionality for managing password reset tokens and password expiration for user accounts. It includes methods to generate, validate, and clear reset password tokens, as well as to check if a user’s password has expired.</p>

<p>It also includes validations for password complexity and length.</p>

<p>## Usage Include this module in your User model to enable password reset functionality. It requires the model to have a ‘password_digest` attribute for secure password storage. The module also provides methods to handle password reset tokens and password expiration.</p>

<p>## Example</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'><span class='object_link'><a href="User.html" title="Securial::User (class)">User</a></span></span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="ApplicationRecord.html" title="Securial::ApplicationRecord (class)">ApplicationRecord</a></span></span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'><span class='object_link'><a href="../Securial.html" title="Securial (module)">Securial</a></span></span><span class='op'>::</span><span class='const'>PasswordResettable</span>
  <span class='comment'># Additional user model code...
</span><span class='kw'>end</span>
</code></pre>

<p>## Configuration The module uses the Securial configuration for password complexity, length, and reset password token expiration settings. You can configure these settings in your Securial initializer.</p>

<p>## Validations</p>
<ul><li>
<p>Password must meet complexity requirements defined in Securial.configuration</p>
</li><li>
<p>Password must be at least Securial.configuration.password_min_length characters long</p>
</li><li>
<p>Password must be at most Securial.configuration.password_max_length characters long</p>
</li><li>
<p>Password confirmation must be present if a new password is being set or if the password is not nil</p>
</li><li>
<p>Reset password token must be generated and cleared appropriately</p>
</li><li>
<p>Password expiration is managed based on the Securial.configuration.password_expires_in setting</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear_reset_password_token!-instance_method" title="#clear_reset_password_token! (instance method)">#<strong>clear_reset_password_token!</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Clears the reset password token and its creation time.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_reset_password_token!-instance_method" title="#generate_reset_password_token! (instance method)">#<strong>generate_reset_password_token!</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generates a secure reset password token for the user.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#password_expired%3F-instance_method" title="#password_expired? (instance method)">#<strong>password_expired?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if the user’s password has expired.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_password_token_valid%3F-instance_method" title="#reset_password_token_valid? (instance method)">#<strong>reset_password_token_valid?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if the reset password token is valid.</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#update_password_changed_at-instance_method" title="#update_password_changed_at (instance method)">#<strong>update_password_changed_at</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Updates the password_changed_at timestamp to the current time.</p>
</div></span>
  
</li>

      
    </ul>
  


  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="clear_reset_password_token!-instance_method">
  
    #<strong>clear_reset_password_token!</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Clears the reset password token and its creation time.</p>

<p>This method is typically called after a successful password reset to prevent the token from being reused.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/concerns/securial/password_resettable.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_clear_reset_password_token!'>clear_reset_password_token!</span>
  <span class='id identifier rubyid_update!'>update!</span><span class='lparen'>(</span>
    <span class='label'>reset_password_token:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='label'>reset_password_token_created_at:</span> <span class='kw'>nil</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate_reset_password_token!-instance_method">
  
    #<strong>generate_reset_password_token!</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Generates a secure reset password token for the user.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/concerns/securial/password_resettable.rb', line 62</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate_reset_password_token!'>generate_reset_password_token!</span>
  <span class='id identifier rubyid_update!'>update!</span><span class='lparen'>(</span>
    <span class='label'>reset_password_token:</span> <span class='const'><span class='object_link'><a href="Auth.html" title="Securial::Auth (module)">Auth</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Auth/TokenGenerator.html" title="Securial::Auth::TokenGenerator (module)">TokenGenerator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_generate_password_reset_token'><span class='object_link'><a href="Auth/TokenGenerator.html#generate_password_reset_token-instance_method" title="Securial::Auth::TokenGenerator#generate_password_reset_token (method)">generate_password_reset_token</a></span></span><span class='comma'>,</span>
    <span class='label'>reset_password_token_created_at:</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="password_expired?-instance_method">
  
    #<strong>password_expired?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>The method checks both the presence of the password_changed_at timestamp and the configured expiration duration.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>If the password_changed_at timestamp is blank, it returns false.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>If the password is expired, it returns true.</p>
</div>
  </div>


<p>Checks if the user’s password has expired.</p>

<p>The password is considered expired if the last time it was changed is older than the configured expiration duration.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_password_expired?'>password_expired?</span> <span class='comment'># =&gt; true or false</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns true if the password is expired, false otherwise.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


114
115
116
117
118
119</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/concerns/securial/password_resettable.rb', line 114</span>

<span class='kw'>def</span> <span class='id identifier rubyid_password_expired?'>password_expired?</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="../Securial.html" title="Securial (module)">Securial</a></span></span><span class='period'>.</span><span class='id identifier rubyid_configuration'><span class='object_link'><a href="../Securial.html#configuration-instance_method" title="Securial#configuration (method)">configuration</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_expires'>password_expires</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_password_changed_at'>password_changed_at</span>

  <span class='id identifier rubyid_password_changed_at'>password_changed_at</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../Securial.html" title="Securial (module)">Securial</a></span></span><span class='period'>.</span><span class='id identifier rubyid_configuration'><span class='object_link'><a href="../Securial.html#configuration-instance_method" title="Securial#configuration (method)">configuration</a></span></span><span class='period'>.</span><span class='id identifier rubyid_password_expires_in'>password_expires_in</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset_password_token_valid?-instance_method">
  
    #<strong>reset_password_token_valid?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>The method checks both the presence of the token and its creation time.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>If the token is blank or the creation time is blank, it returns false.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>If the token is expired, it returns false.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>The method uses the configured expiration duration from Securial.configuration.</p>
</div>
  </div>


<p>Checks if the reset password token is valid.</p>

<p>The token is considered valid if it was created within the configured expiration duration.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_reset_password_token_valid?'>reset_password_token_valid?</span> <span class='comment'># =&gt; true or false</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns true if the reset password token is valid, false otherwise.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/concerns/securial/password_resettable.rb', line 80</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_password_token_valid?'>reset_password_token_valid?</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_reset_password_token'>reset_password_token</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='op'>||</span> <span class='id identifier rubyid_reset_password_token_created_at'>reset_password_token_created_at</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>

  <span class='id identifier rubyid_duration'>duration</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Securial.html" title="Securial (module)">Securial</a></span></span><span class='period'>.</span><span class='id identifier rubyid_configuration'><span class='object_link'><a href="../Securial.html#configuration-instance_method" title="Securial#configuration (method)">configuration</a></span></span><span class='period'>.</span><span class='id identifier rubyid_reset_password_token_expires_in'>reset_password_token_expires_in</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_duration'>duration</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>ActiveSupport</span><span class='op'>::</span><span class='const'>Duration</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_reset_password_token_created_at'>reset_password_token_created_at</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_duration'>duration</span><span class='period'>.</span><span class='id identifier rubyid_ago'>ago</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_password_changed_at-instance_method">
  
    #<strong>update_password_changed_at</strong>  &#x21d2; <tt>void</tt>  <span class="extras">(private)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Updates the password_changed_at timestamp to the current time.</p>

<p>This method is called before saving the user record if the password digest has changed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/concerns/securial/password_resettable.rb', line 128</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_password_changed_at'>update_password_changed_at</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_password_changed_at'>password_changed_at</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Jul  8 15:13:28 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.4).
</div>

    </div>
  </body>
</html>